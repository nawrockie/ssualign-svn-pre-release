\section{Introduction}

\software{ssu-align} identifies and aligns small subunit ribosomal RNA
(SSU rRNA) genes in sequence datasets. It uses models of the primary
sequence and secondary structure conservation of SSU rRNA as inferred
by comparative sequence analysis and confirmed by crystal structure
determination from the \db{comparative rna website} (\db{crw}) 
(\htmladdnormallink{http://www.rna.ccbb.utexas.edu/}{http://www.rna.ccbb.utexas.edu/})
\cite{CannoneGutell02}.

\subsection{Overview}
\software{ssu-align} uses profile probabilistic models called
covariance models (CMs) for SSU rRNA detection and alignment. It
includes three SSU rRNA models, an archaeal model, a bacterial model,
and a eukaryotic (nuclear) model.  These are the default models used
by the program, but \textsc{ssu-align} can be used with other,
user-generated models as well.

Given an input dataset of unaligned SSU sequences,
\software{ssu-align} proceeds through two stages to generate
alignments. In stage 1, each of the sequences is aligned to
each of the three models based on primary sequence conservation to
obtain a score for each sequence to each model.  The model that gives
the highest scoring alignment to each sequence is the
\emph{best-matching model} for that sequence.  In stage 2, each
sequence is aligned to its best-matching model using both primary
sequence and secondary structure conservation information. The end result is a
separate multiple alignment for each model that was the best-matching
model for at least one sequence in the input dataset.

The stage 1 primary sequence alignment is local with respect to both
the model and the sequence. Locality with respect to the model allows
the program to handle sequences that are subsequences of SSU
rRNA that correspond to a specific region of the molecule. Locality
with respect to the sequence allows the program to handle input
sequences that contain extra residues that are nonhomologous to SSU at
the beginning and/or end of the input sequence. In this case, the
local alignment will only correspond to a subsequence of the input
sequence. It is only this subsequence that is aligned to its
best-matching model in stage 2.
The stage 2 primary sequence and structural based alignment is local
\emph{only} with respect to the model.  This means that any subsequence
that survives stage 1 is always included in its entirety in the final
alignment.

This package can also be used to \emph{mask} alignments by removing
unreliable alignment columns. This post-processing step can be useful
for removing ambiguously aligned regions that probably include a
significant number of errors prior to using phylogenetic inference
tools.  Alignment columns are selected for removal based on
automatically calculated ``confidence estimates'' for the aligned
residues, which are literally the probabilities that each residue belongs
in each column of the alignment given the CM. This is discussed in
more detail in the section 3 of this guide.

This package can also be used to create new SSU models, either for
different phylogenetic clades or for specific regions of the SSU rRNA
molecule, as well as for drawing secondary structure diagrams that
display several different statistics on the alignment (such as levels
of sequence conservation or frequency of gaps). 

\subsection{What is included in this guide}

Section~\ref{section:install} describes how to install the
package. Section~\ref{section:chap9} is a chapter from my (submitted)
Ph.D. thesis \cite{Nawrocki09b} which describes how the program works,
and how the seed alignments were derived from \db{crw}
\cite{CannoneGutell02}.  The tutorial in
section~\ref{section:tutorial} walks through examples of using
\textsc{ssu-align} to build multiple alignments, mask alignments,
create models of a specific region of SSU, draw structure diagrams for
alignments, and split up large alignment jobs into smaller jobs to run
in parallel on a cluster.  Section~\ref{section:output} describes the
format of all the output files \sft{ssu-align} creates. Finally, the
\sft{ssu-align} Manual page, which explains the command-line options of
the program, is included at the end of this guide.

\subsection{What is included in this package}

\sft{ssu-align} is part of the \sft{infernal} package. The
\sft{infernal} distribution includes the \sft{perl} script
\software{ssu-align} and all the files necessary to compile and run it
and the \sft{infernal} suite of programs (version 1.01)
\cite{Nawrocki09}. \software{infernal} must be installed in order to
run \software{ssu-align} as explained in the Installation section of
this guide. Also included are the three default (archaea, bacteria,
and eukarya) SSU models and the \emph{seed} alignments they were built
from. These alignments were based on SSU structures and alignments
from the Comparative RNA Website (CRW) \cite{CannoneGutell02}. A
broader discussion of these models and alignments and the specific
procedure used to create them from the CRW data is explained in
section~\ref{section:chap9}.

Installation of the \sft{perl} (Practical Extraction and Report Language,
Larry Wall) interpreter package version 5.0 or later is required to
run the \software{ssu-align} \sft{perl} script.

\subsection{What SSU-align does not do}

\textsc{ssu-align} only creates alignments; it does not infer trees
from those alignments, nor does it classify sequences beyond reporting
which model in the input CM file they score highest to.

\subsection{Other useful references}

The \software{infernal} user's guide \cite{infernalguide} included in
this package supplements this user's guide. My Ph.D. thesis 
(\htmladdnormallink{http://selab.janelia.org/publications.html}{http://selab.janelia.org/publications.html})
introduces and describes my work on CM methods. It includes three chapters (7-9) dedicated to
SSU rRNA alignment; chapter 9 is included in this guide as
section~\ref{section:chap9}, but the other chapters may include some
relevant background information as well. 
Other useful references on CMs include
\cite{Eddy94,Eddy02b,NawrockiEddy07,Nawrocki09,KolbeEddy09}. In
addition, the \database{rfam} database 
(\htmladdnormallink{http://rfam.sanger.ac.uk/}{http://rfam.sanger.ac.uk/})
uses \software{infernal} to search for and align
structural RNAs using more than 1000 different CMs, so its
publications may be of interest as well
\cite{Griffiths-Jones03,Griffiths-Jones05,Gardner09}.

\subsection{How to cite INFERNAL and SSU-align}

Please cite the \sft{infernal} software publication:
\cite{Nawrocki09}, if you find \sft{ssu-align} useful for work that
you publish. Additionally, because \sft{ssu-align}'s seed alignments were
derived from the \db{comparative rna website} we ask that you cite
that database as well: \cite{CannoneGutell02}. 
%Finally, if you'd like to, you
%can also cite my Ph.D. thesis \cite{Nawrocki09b} because it is
%currently the most relevant and comprehensive reference for the
%program.

\subsection{Future development}

This release (version 0.1) is a prototype of \textsc{ssu-align} that
only has basic functionality for aligning SSU sequences. I hope to
continue to develop and improve it in the future by making it faster
and generally more useful to the SSU rRNA sequence analysis
community. Bug reports and feature requests are appreciated.
